# PHYS 515     Assignment # 4    

**Due: Monday, Dec 11, 10am PST**

Perform this homework on the `ppmstar` hub of the [ppmstar.org](https://www.ppmstar.org) virtual research platform. Use your work from homework 1 to 3. Your solution consists of a number of files, such as a Python program and a notebook to plot the data you generated, and any other notebook, program or Markdown file you may want to generate. You submit your work by creating in your `ppmstar` hub directory in `/user/scratch14_ppmstar` a directory called `Assignment`. It contains a file `README.md` in which you list all files that are part of your solution and document where each of the parts below is covered. The directory should not contain any additional files not listed, and if it does those will be ignored. You will then create a zip file of the `Assignment` directory and call it `Assignment_First_LastName_date.zip`. You download this zip file using the built-in JupyterLab file manager and send it to me by email fherwig@uvic.ca

Cover each of the following points in your solution notebook

#### Rationale

The goal of this assignment is to compare different approaches to to distinguish wave regions and convection regions in stellar hydrodynamic simulations. We discussed the science background of this problem in class and you find numerical examples of how to analyse and visualize the problem in the homework notebooks 2 and3. In short, the simulation `M276` has a convective core to a radius of about $1500\mathrm{Mm}$ and outside that radius a stable stratification in which motions occur according to the superposition of hundreds of internal standing gravity waves. It was found that in the wave region the distribution of the radial velocity component $u_\mathrm{r}$ on the sphere of a given radius is well described by a normal distribution, whereas the  $u_\mathrm{r}$ distribution on a sphere of a radius in the convection zone is characterized by a larger skew and excess kurtosis compared to the normal distribution (see [Fig. 9 and 22 in Herwig et al. 2023](https://ui.adsabs.harvard.edu/abs/2023MNRAS.525.1601H)). Here we want to explore how other data analysis approaches compare, especially

* Hypothesis testing with the Kolmogorov-Smirnov (KS) test and the Anderson-Darling (AD) test
* Properties of the spatial spectrum, specifically the angular degree at which the maximum power is located

**A note about grading:** Parts 1-4 each have a maximum of 10 points and the assignment will be graded out of 40. Part 5 is optional in the sense that any points gained there can offset lower than full points in previous parts. 

Specifically cover the following points:

1. Extract the $u_\mathrm{r}$ distribution at a radius (a) in the convection zone and (b) in the wave region. Use the template from one of the homework notebooks, and document how you convince yourself that this is done correctly by reproducing qualitatively the higher-order moments reported in  [Fig. 9 in Herwig et al. 2023](https://ui.adsabs.harvard.edu/abs/2023MNRAS.525.1601H). The run you are analyzing is not the same as the one shown in the paper, but similar enough so that the differences between wave and convection zone should show up in a similar way if the data is extracted correctly. (The data stored in the files is in units of Mm/s!) [10]
1. Develop a numerical approach to calculate the KS and AD statistics with regard to the hypothesis that the  $u_\mathrm{r}$ distribution for a given radius is drawn from a normal distribution. If you are using a library (which is encouraged) you must document how you have convinced yourself that you are using the library correctly (verification). Demonstrate the approach for radii that are located well inside the convection zone and in the wave zone and explain if and why your test results make sense.  <u>Note:</u> For statistics you want to extract the $u_\mathrm{r}$ data for a reduced number for `npoints`, corresponding to angular degrees $l \approx < 45$ (see `Mollweide_HW2.ipynb`) which is $l \approx l_\mathrm{max}/5$ or maybe even more reduced, your choice. [10]
1. Develop a numerical approach to determine the spherical harmonic angular degree `max_ell` of the spatial power spectrum of  $u_\mathrm{r}$  that contains the maximum power. First, document your qualitative comparison of the spatial spectra with the results shown in [Fig. 20 in Herwig et al. 2023](https://ui.adsabs.harvard.edu/abs/2023MNRAS.525.1601H). Consider smoothing the spectrum, for example with a moving average approach (symmetric or asymmetric?) , to make finding the maximum more reliable. For the latter think about how distant in time dumps should be for time averaging. Make sure to test your approach visually. <u>Note:</u> For spectra you want to extract the $u_\mathrm{r}$ data for the maximum possible number for `npoints` so that your spectra extend to the highest ell possible for more reliable maximum finding. How does the `max_ell` differ between convective and wave regions? [10]
1. Write a program that evaluates the KS and AD statistics, `max_ell` as well as the higher-order moments product skew times excess kurtosis for a range of radii between $1000$ and $2000\mathrm{Mm}$ with spatial resolution $\Delta R = 5\mathrm{Mm}$, for a given dump. Dumps with 3D data available on the ppmstar hub are complete in the range $[4000,4999]$. This will provide you with radial profiles of these quantities for that dump in the given radius range. Make a plot of these quantities where you use an appropriate scaling factor for each quantity if needed, so that all appear appropriately in the same figure.  Interpret your findings. Are the additional aproaches tested in this assignment suitable to distinguish wave and convection zone. [10]
1. Optional: Extend your program to process several dumps in the available range and take the average for each quantity profile over these dumps. This will remove short time-scale fluctuations due to the intermittent nature of convection and wave velocity fields. Again, plot the time- or dump-averaged profiles and check that they are a smoother version of the individual dump profiles. You will find that without using threading using all dumps or even a substantial fraction of them will take a lot of time to compute. In order to cut down on the computing time add parallel computing capability to your program. For example, using the `multiprocessing` package you could distribute the dump processing over 10 threads, thus processing 10 dumps simultaneously. In this way it could be possible to process every $10^{th}$ dump with the given radial resolution in $12$ to $15$ minutes. Make a plot of your final and best-averaged profiles. Does your finding and interpretation from 4 change? [10]
